<!-- dashboard/templates/dashboard/admin_dashboard.html -->
{% extends 'base.html' %}

{% block title %}Admin Dashboard - WePool{% endblock %}

{% block content %}
<div class="container-fluid">
    <h2>Admin Dashboard</h2>

    <style>
    .admin-stats-card {
        border: 1px solid var(--border-color, #e2e8f0);
        border-radius: 12px;
        background: #ffffff;
        box-shadow: 0 2px 6px rgba(0,0,0,0.04);
        height: 100%;
    }
    .admin-stats-card .card-body { padding: 1rem 1.25rem; }
    .admin-stats-label { color: #64748b; font-size: 0.9rem; margin-bottom: 0.25rem; }
    .admin-stats-value { color: #0f172a; font-size: 1.8rem; font-weight: 700; margin: 0; }
    .admin-stats-sub { color: #64748b; font-size: 0.9rem; margin: 0; }
    .accent-primary { border-left: 4px solid #3b82f6; }
    .accent-info { border-left: 4px solid #06b6d4; }
    .accent-success { border-left: 4px solid #10b981; }
    .accent-warning { border-left: 4px solid #f59e0b; }
    </style>

    <!-- Statistics Cards -->
    <div class="row mb-4" id="stats-container">
        <!-- Stats will be loaded via AJAX -->
    </div>

    <!-- Quick Actions -->
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5>Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'view_all_users' %}" class="btn btn-primary btn-block w-100">
                                <i class="fas fa-users"></i> View All Users
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'paying_queue' %}" class="btn btn-info btn-block w-100">
                                <i class="fas fa-dollar-sign"></i> Paying Queue
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'sponsored_queue' %}" class="btn btn-warning btn-block w-100">
                                <i class="fas fa-hand-holding-usd"></i> Sponsored Queue
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'assign_members' %}" class="btn btn-success btn-block w-100">
                                <i class="fas fa-link"></i> Assign Members
                            </a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'yellow_members' %}" class="btn btn-warning btn-block w-100">
                                <i class="fas fa-star"></i> Yellow Members
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'qualified_sponsored' %}" class="btn btn-success btn-block w-100">
                                <i class="fas fa-check-circle"></i> Qualified Sponsored
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'export_data' %}" class="btn btn-secondary btn-block w-100">
                                <i class="fas fa-download"></i> Export Data
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'admin:index' %}" class="btn btn-dark btn-block w-100">
                                <i class="fas fa-cog"></i> Django Admin
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>Recent Registrations</h5>
                </div>
                <div class="card-body" id="recent-registrations">
                    <!-- Will be populated via AJAX -->
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>Recent Assignments</h5>
                </div>
                <div class="card-body" id="recent-assignments">
                    <!-- Will be populated via AJAX -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Load dashboard statistics
function loadStats() {
    fetch("{% url 'dashboard_stats' %}")
        .then(response => response.json())
        .then(data => {
            const statsHTML = `
                <div class="col-md-3 mb-3">
                    <div class="card admin-stats-card accent-primary">
                        <div class="card-body">
                            <div class="admin-stats-label">Total Users</div>
                            <p class="admin-stats-value">${data.total_users}</p>
                            <p class="admin-stats-sub">Paying: ${data.paying_members} | Sponsored: ${data.sponsored_members}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card admin-stats-card accent-info">
                        <div class="card-body">
                            <div class="admin-stats-label">Status Breakdown</div>
                            <p class="admin-stats-sub mb-1">Pending: ${data.status_breakdown.pending}</p>
                            <p class="admin-stats-sub mb-1">Yellow: ${data.status_breakdown.yellow}</p>
                            <p class="admin-stats-sub mb-0">Green: ${data.status_breakdown.green}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card admin-stats-card accent-success">
                        <div class="card-body">
                            <div class="admin-stats-label">Assignments</div>
                            <p class="admin-stats-value">${data.assignments.completed}</p>
                            <p class="admin-stats-sub">Completed assignments</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card admin-stats-card accent-warning">
                        <div class="card-body">
                            <div class="admin-stats-label">Recent Activity</div>
                            <p class="admin-stats-value">${data.recent_registrations}</p>
                            <p class="admin-stats-sub">New users (last 7 days)</p>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('stats-container').innerHTML = statsHTML;
        });
}

// Load stats on page load
document.addEventListener('DOMContentLoaded', loadStats);
</script>
{% endblock %}
